[build]
  environment = { PYTHON_VERSION = "3.12", PNPM_FLAGS = "--shamefully-hoist" }
  publish = "docs/_build/html"
  command = """
    # Clone and build mystmd from main branch
    git clone --depth 1 https://github.com/jupyter-book/mystmd.git /tmp/mystmd && \
    cd /tmp/mystmd && \
    pnpm install && \
    pnpm run build && \
    pnpm run link && \
    cd - && \
    # Build myst-theme
    pnpm install && \
    pnpm run build && \
    # Install Python requirements and build docs
    pip install uv && \
    python -m uv pip install -r docs/requirements.txt --system && \
    make build-docs
  """